# 【Linux】查看日志相关命令总结

[TOC]



## 概述

Linux查看命令有多种：tail，head，cat，tac，more

## 数据截取

###  tail 命令

**选项与参数**

**-f** 循环读取，实时显示日志文件
**-q** 不显示处理信息
**-v** 显示详细的处理信息
**-c<数目>** 显示的字节数
**-n<行数>** 显示行数 ，注意当n后面值**带“+”号表示从第x行开始**， 如 `tail -n +1000 test.txt`

**示例**

| 命令                  | 含义                       |
| --------------------- | -------------------------- |
| `tail -f test.log`    | 查看实时日志               |
| tail -100f test.log   | 查看最后100行日志记录      |
| tail -n 10 test.log   | 查询日志尾部最后10行的日志 |
| tail -n +10 test.log  | 查询10行之后的所有日志     |
| tail -fn 100 test.log | 循环实时查看最后100行记录  |




###  head 命令

跟tail命令相反

| 命令                 | 含义                                   |
| -------------------- | -------------------------------------- |
| head -n 10 test.log  | 查询日志文件中的前10行日志             |
| head -n -10 test.log | 查询日志文件除了最后10行的其他所有日志 |

## 直接查看文件内容

### cat 命令

```shell
cat [-AbEnTv]
```

**选项与参数**
**-A** ：相当于-vET的整合， 可以列出一些特殊字符而不是空白而已

**-b** ：列出行号，针对非空白行做行号显示，空白行不会标记

**-E** ：将结尾换行符$显示出来

**-n** ：打印出行号，连同空白行也会有行号，与-b的选项不同

**-T** :  将[tab]键以^I显示出来

**-v** :  列出一些看不出来的特殊字符

**-s** ： 当遇到有连续两行以上的空白行，就代换为一行的空白行
-c<数目> ： 显示的字节数

**示例**

- `cat test.log | tail -n 1000` #输出test.log 文件最后1000行
- `cat -n test.log |grep “debug”` #得到关键日志的行号
- `cat filename | tail -n +3000 | head -n 1000` #从第3000行开始，显示1000行。即显示3000~3999行
- `cat filename| head -n 3000 | tail -n +1000` #显示1000行到3000行
- `cat -n textfile1 > textfile2` #把 textfile1 的档案内容加上行号后输入 textfile2 这个档案里
- `cat -b textfile1 textfile2 >> textfile3` #把 textfile1 和 textfile2 的档案内容加上行号（空白行不加）之后将内容附加到 textfile3 里

> **cat仅仅适合查看行数比较少的文件**， 如果文件比较大则没有什么意义了，文件会快速翻到最后一行。如果文件中有特殊符号，比如[Tab], 换行等要显示出来，就必须加上-A之类的选项。当然cat也可以通过管道符配合more或less使用也可以达到比较好的效果。

3）cat filename | tail -n +3000 | head -n 1000 #从第3000行开始，显示1000行。即显示3000~3999行

4）cat filename| head -n 3000 | tail -n +1000 #显示1000行到3000行

5）cat -n textfile1 > textfile2 #把 textfile1 的档案内容加上行号后输入 textfile2 这个档案里

6）cat -b textfile1 textfile2 >> textfile3 #把 textfile1 和 textfile2 的档案内容加上行号（空白行不加）之后将内容附加到 textfile3 里

###  tac 命令

```shell
tac（和cat打印顺序相反）
```

tac是将cat反写过来，它的功能跟cat相反，cat是由第一行到最后一行连续显示，而tac是由最后一行到第一行反向显示。

## 翻页查看

###  more 命令

```shell
more filename
```

**类似cat，不过以一页一页形式显示。more命令了解一下就行了，功能太少，一般都用less命令。**

**相关操作**
**空格键（Space）**：向下翻页
**回车（Enter）**：向下翻行
**/字符串**：在当前显示的内容（翻页进度位置），向下查找这个字符串关键字
**:f **：立刻显示文件名以及目前位置的行号
**q:** ：退出当前文件的浏览
**b或ctrl+b**：往回翻页

**选项与参数**

**-num** 一次显示的行数

**-d** 提示使用者，在画面下方显示 [Press space to continue, ‘q’ to quit.] ，如果使用者按错键，则会显示 [Press ‘h’ for instructions.] 而不是 ‘哔’ 声

**-l** 取消遇见特殊字元 ^L 时会暂停的功能

**-f** 计算行数时，以实际上的行数，而非自动换行过后的行数

**-p** 不以卷动的方式显示每一页，而是先清除萤幕后再显示内容

**-c** 跟 -p 相似，不同的是先显示内容再清除其他旧资料

**-s** 当遇到有连续两行以上的空白行，就代换为一行的空白行

**-u** 不显示下引号 （根据环境变数 TERM 指定的 terminal 而有所不同）

**+/pattern** 在每个文档显示前搜寻该字串（pattern），然后从该字串之后开始显示

**+num** 从第 num 行开始显示

**示例**

- `more -s test.log` 	逐页显示日志，如有连续两行以上空白行则以一行空白行显示
- `more +20 test.log` 	从第 20 行开始显示日志内容

### Less命令

less命令比more更加有弹性，可以前后翻页，不止可以向上查找，也可以向下查找。

**按键/命令**
**[pagedown]** ：向下翻页
**[pageup]** ：向上翻页
**/字符串**：在当前显示的内容（翻页进度位置），向下查找这个字符串关键字
**?字符串**：向上查找字符串
**n** ：重复前一个查找，与/或?有关， 比如前一个命令是？表示向上查找，此时n会向上查找
**N**:  反向的重复前一个查找
**g** ：跳转到当前文件数据的第一行
**G** ：跳转到当前文件数据的最后一行
**q** ：退出当前文件的浏览

## 通用命令

**管道**：Shell 还有一种功能，就是可以将两个或者多个命令（程序或者进程）连接到一起**，把一个命令的输出作为下一个命令的输入**，以这种方式连接的两个或者多个命令就形成了管道（pipe），管道命令**用"|"来表示**。

### grep 命令

**功能**

上面几个命令都是用在查找文件方便，而在查找文件时，我们往往需要通过某些关键字查找，grep命令就可以帮助我们实现快速查找。

**示例**

`more joint.log | grep ‘60007746’` #根据某退货号查询日志

`more joint.log | grep -5 ‘60007746’` #打印匹配行的前后5行

`more joint.log | grep -C 5 ‘60007746’` #打印匹配行的前后5行

`more joint.log | grep -A 5 ‘60007746’` #打印匹配行的后5行

`more joint.log | grep -B 5 ‘60007746’` #打印匹配行的前5行在这里插入图片描述

## 总结

熟悉常用的Linux命令也是我们必须要掌握的一项技能，这样在查找问题过程中也能更加高效速度


## 参考资料

1. https://blog.csdn.net/hu_zhiting/article/details/88319528